/**
 * Highcharts JS v12.4.0-modified (2025-11-13)
 * Treegraph chart series type
 * @module highcharts/modules/treegraph
 * @requires highcharts
 * @requires highcharts/modules/treemap
 *
 *  (c) 2010-2025 Pawel Lysy Grzegorz Blachlinski
 *
 * License: www.highcharts.com/license
 */import*as t from"../highcharts.js";import*as e from"./coloraxis.js";var i,s={};s.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return s.d(e,{a:e}),e},s.d=(t,e)=>{for(var i in e)s.o(e,i)&&!s.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},s.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);let o=t.default;var l=s.n(o);let r={mainBreadcrumb:"Main"},a=t.default.Templating,{format:n}=s.n(a)(),{composed:h}=l(),{addEvent:d,defined:p,extend:u,fireEvent:c,isString:g,merge:f,objectEach:v,pick:m,pushUnique:b}=l();function y(){if(this.breadcrumbs){let t=this.resetZoomButton&&this.resetZoomButton.getBBox(),e=this.breadcrumbs.options;t&&"right"===e.position.align&&"plotBox"===e.relativeTo&&this.breadcrumbs.alignBreadcrumbsGroup(-t.width-e.buttonSpacing)}}function x(){this.breadcrumbs&&(this.breadcrumbs.destroy(),this.breadcrumbs=void 0)}function L(){let t=this.breadcrumbs;if(t&&!t.options.floating&&t.level){let e=t.options,i=e.buttonTheme,s=(i.height||0)+2*(i.padding||0)+e.buttonSpacing,o=e.position.verticalAlign;"bottom"===o?(this.marginBottom=(this.marginBottom||0)+s,t.yOffset=s):"middle"!==o?(this.plotTop+=s,t.yOffset=-s):t.yOffset=void 0}}function P(){this.breadcrumbs&&this.breadcrumbs.redraw()}function T(t){!0===t.resetSelection&&this.breadcrumbs&&this.breadcrumbs.alignBreadcrumbsGroup()}class k{static compose(t,e){b(h,"Breadcrumbs")&&(d(t,"destroy",x),d(t,"afterShowResetZoom",y),d(t,"getMargins",L),d(t,"redraw",P),d(t,"selection",T),u(e.lang,r))}constructor(t,e){this.elementList={},this.isDirty=!0,this.level=0,this.list=[];let i=f(t.options.drilldown&&t.options.drilldown.drillUpButton,k.defaultOptions,t.options.navigation&&t.options.navigation.breadcrumbs,e);this.chart=t,this.options=i||{}}updateProperties(t){this.setList(t),this.setLevel(),this.isDirty=!0}setList(t){this.list=t}setLevel(){this.level=this.list.length&&this.list.length-1}getLevel(){return this.level}getButtonText(t){let e=this.chart,i=this.options,s=e.options.lang,o=m(i.format,i.showFullPath?"{level.name}":"← {level.name}"),l=s&&m(s.drillUpText,s.mainBreadcrumb),r=i.formatter&&i.formatter(t)||n(o,{level:t.levelOptions},e)||"";return(g(r)&&!r.length||"← "===r)&&p(l)&&(r=i.showFullPath?l:"← "+l),r}redraw(){this.isDirty&&this.render(),this.group&&this.group.align(),this.isDirty=!1}render(){let t=this.chart,e=this.options;!this.group&&e&&(this.group=t.renderer.g("breadcrumbs-group").addClass("highcharts-no-tooltip highcharts-breadcrumbs").attr({zIndex:e.zIndex}).add()),e.showFullPath?this.renderFullPathButtons():this.renderSingleButton(),this.alignBreadcrumbsGroup()}renderFullPathButtons(){this.destroySingleButton(),this.resetElementListState(),this.updateListElements(),this.destroyListElements()}renderSingleButton(){let t=this.chart,e=this.list,i=this.options.buttonSpacing;this.destroyListElements();let s=this.group?this.group.getBBox().width:i,o=e[e.length-2];!t.drillUpButton&&this.level>0?t.drillUpButton=this.renderButton(o,s,i):t.drillUpButton&&(this.level>0?this.updateSingleButton():this.destroySingleButton())}alignBreadcrumbsGroup(t){if(this.group){let e=this.options,i=e.buttonTheme,s=e.position,o="chart"===e.relativeTo||"spacingBox"===e.relativeTo?void 0:"plotBox",l=this.group.getBBox(),r=2*(i.padding||0)+e.buttonSpacing;s.width=l.width+r,s.height=l.height+r;let a=f(s);t&&(a.x+=t),this.options.rtl&&(a.x+=s.width),a.y=m(a.y,this.yOffset,0),this.group.align(a,!0,o)}}renderButton(t,e,i){let s=this,o=this.chart,l=s.options,r=f(l.buttonTheme),a=o.renderer.button(s.getButtonText(t),e,i,function(e){let i,o=l.events&&l.events.click;o&&(i=o.call(s,e,t)),!1!==i&&(l.showFullPath?e.newLevel=t.level:e.newLevel=s.level-1,c(s,"up",e))},r).addClass("highcharts-breadcrumbs-button").add(s.group);return o.styledMode||a.attr(l.style),a}renderSeparator(t,e){let i=this.chart,s=this.options.separator,o=i.renderer.label(s.text,t,e,void 0,void 0,void 0,!1).addClass("highcharts-breadcrumbs-separator").add(this.group);return i.styledMode||o.css(s.style),o}update(t){f(!0,this.options,t),this.destroy(),this.isDirty=!0}updateSingleButton(){let t=this.chart,e=this.list[this.level-1];t.drillUpButton&&t.drillUpButton.attr({text:this.getButtonText(e)})}destroy(){this.destroySingleButton(),this.destroyListElements(!0),this.group&&this.group.destroy(),this.group=void 0}destroyListElements(t){let e=this.elementList;v(e,(i,s)=>{(t||!e[s].updated)&&((i=e[s]).button&&i.button.destroy(),i.separator&&i.separator.destroy(),delete i.button,delete i.separator,delete e[s])}),t&&(this.elementList={})}destroySingleButton(){this.chart.drillUpButton&&(this.chart.drillUpButton.destroy(),this.chart.drillUpButton=void 0)}resetElementListState(){v(this.elementList,t=>{t.updated=!1})}updateListElements(){let t=this.elementList,e=this.options.buttonSpacing,i=this.list,s=this.options.rtl,o=s?-1:1,l=function(t,e){return o*t.getBBox().width+o*e},r=function(t,e,i){t.translate(e-t.getBBox().width,i)},a=this.group?l(this.group,e):e,n,h;for(let d=0,p=i.length;d<p;++d){let u,c,g=d===p-1;t[(h=i[d]).level]?(u=(n=t[h.level]).button,n.separator||g?n.separator&&g&&(n.separator.destroy(),delete n.separator):(a+=o*e,n.separator=this.renderSeparator(a,e),s&&r(n.separator,a,e),a+=l(n.separator,e)),t[h.level].updated=!0):(u=this.renderButton(h,a,e),s&&r(u,a,e),a+=l(u,e),g||(c=this.renderSeparator(a,e),s&&r(c,a,e),a+=l(c,e)),t[h.level]={button:u,separator:c,updated:!0}),u&&u.setState(2*!!g)}}}k.defaultOptions={buttonTheme:{fill:"none",height:18,padding:2,"stroke-width":0,zIndex:7,states:{select:{fill:"none"}},style:{color:"#334eff"}},buttonSpacing:5,floating:!1,format:void 0,relativeTo:"plotBox",rtl:!1,position:{align:"left",verticalAlign:"top",x:0,y:void 0},separator:{text:"/",style:{color:"#666666",fontSize:"0.8em"}},showFullPath:!0,style:{},useHTML:!1,zIndex:7};let w=t.default.Color;var B=s.n(w);let C=e.default.ColorMapComposition;var A=s.n(C);let O=t.default.Series;var M=s.n(O);let N=t.default.SeriesRegistry;var S=s.n(N);let R=class{constructor(t,e,i,s){this.height=t,this.width=e,this.plot=s,this.direction=i,this.startDirection=i,this.total=0,this.nW=0,this.lW=0,this.nH=0,this.lH=0,this.elArr=[],this.lP={total:0,lH:0,nH:0,lW:0,nW:0,nR:0,lR:0,aspectRatio:function(t,e){return Math.max(t/e,e/t)}}}addElement(t){this.lP.total=this.elArr[this.elArr.length-1],this.total=this.total+t,0===this.direction?(this.lW=this.nW,this.lP.lH=this.lP.total/this.lW,this.lP.lR=this.lP.aspectRatio(this.lW,this.lP.lH),this.nW=this.total/this.height,this.lP.nH=this.lP.total/this.nW,this.lP.nR=this.lP.aspectRatio(this.nW,this.lP.nH)):(this.lH=this.nH,this.lP.lW=this.lP.total/this.lH,this.lP.lR=this.lP.aspectRatio(this.lP.lW,this.lH),this.nH=this.total/this.width,this.lP.nW=this.lP.total/this.nH,this.lP.nR=this.lP.aspectRatio(this.lP.nW,this.nH)),this.elArr.push(t)}reset(){this.nW=0,this.lW=0,this.elArr=[],this.total=0}},D=function(t,e){let{animatableAttribs:i,onComplete:s,css:o,renderer:l}=e,r=t.series&&t.series.chart.hasRendered?void 0:t.series&&t.series.options.animation,a=t.graphic;if(e.attribs={...e.attribs,class:t.getClassName()},t.shouldDraw())a||(t.graphic=a="text"===e.shapeType?l.text():"image"===e.shapeType?l.image(e.imageUrl||"").attr(e.shapeArgs||{}):l[e.shapeType](e.shapeArgs||{}),a.add(e.group)),o&&a.css(o),a.attr(e.attribs).animate(i,!e.isNew&&r,s);else if(a){let e=()=>{t.graphic=a=a&&a.destroy(),"function"==typeof s&&s()};Object.keys(i).length?a.animate(i,void 0,()=>e()):e()}},{pie:{prototype:{pointClass:I}},scatter:{prototype:{pointClass:W}}}=S().seriesTypes,{extend:X,isNumber:E,pick:V}=l();class U extends W{constructor(){super(...arguments),this.groupedPointsAmount=0,this.shapeType="rect"}draw(t){D(this,t)}getClassName(){let t=this.series,e=t.options,i=super.getClassName();return this.node.level<=t.nodeMap[t.rootNode].level&&this.node.children.length?i+=" highcharts-above-level":this.node.isGroup||this.node.isLeaf||t.nodeMap[t.rootNode].isGroup||V(e.interactByLeaf,!e.allowTraversingTree)?this.node.isGroup||this.node.isLeaf||t.nodeMap[t.rootNode].isGroup||(i+=" highcharts-internal-node"):i+=" highcharts-internal-node-interactive",i}isValid(){return!!(this.id||E(this.value))}setState(t){super.setState.apply(this,arguments),this.graphic&&this.graphic.attr({zIndex:+("hover"===t)})}shouldDraw(){return E(this.plotY)&&null!==this.y}}X(U.prototype,{setVisible:I.prototype.setVisible});let{isString:G}=l(),z={allowTraversingTree:!1,animationLimit:250,borderRadius:0,showInLegend:!1,marker:void 0,colorByPoint:!1,dataLabels:{enabled:!0,formatter:function(){let t=this&&this.point?this.point:{};return G(t.name)?t.name:""},headers:!1,inside:!0,padding:2,verticalAlign:"middle",style:{textOverflow:"ellipsis"}},tooltip:{headerFormat:"",pointFormat:"<b>{point.name}</b>: {point.value}<br/>",clusterFormat:"+ {point.groupedPointsAmount} more...<br/>"},ignoreHiddenPoint:!0,layoutAlgorithm:"sliceAndDice",layoutStartingDirection:"vertical",alternateStartingDirection:!1,levelIsConstant:!0,traverseUpButton:{position:{align:"right",x:-10,y:10}},borderColor:"#e6e6e6",borderWidth:1,colorKey:"colorValue",opacity:.15,states:{hover:{borderColor:"#999999",brightness:.1*!S().seriesTypes.heatmap,halo:!1,opacity:.75,shadow:!1}},legendSymbol:"rectangle",traverseToLeaf:!1,cluster:{className:void 0,color:void 0,enabled:!1,pixelWidth:void 0,pixelHeight:void 0,name:void 0,reductionFactor:void 0,minimumClusterSize:5,layoutAlgorithm:{distance:0,gridSize:0,kmeansThreshold:0},marker:{lineWidth:0,radius:0}}};(i||(i={})).recursive=function t(e,i,s){let o=i.call(s||this,e);!1!==o&&t(o,i,s)};let F=i,{extend:H,isArray:Y,isNumber:$,isObject:j,merge:q,pick:K,relativeLength:Z}=l(),_={getColor:function(t,e){let i,s,o,l,r,a,n=e.index,h=e.mapOptionsToLevel,d=e.parentColor,p=e.parentColorIndex,u=e.series,c=e.colors,g=e.siblings,f=u.points,v=u.chart.options.chart;return t&&(i=f[t.i],s=h[t.level]||{},i&&s.colorByPoint&&(l=i.index%(c?c.length:v.colorCount),o=c&&c[l]),u.chart.styledMode||(r=K(i&&i.options.color,s&&s.color,o,d&&(t=>{let e=s&&s.colorVariation;return e&&"brightness"===e.key&&n&&g?B().parse(t).brighten(e.to*(n/g)).get():t})(d),u.color)),a=K(i&&i.options.colorIndex,s&&s.colorIndex,l,p,e.colorIndex)),{color:r,colorIndex:a}},getLevelOptions:function(t){let e,i,s,o,l,r,a={};if(j(t))for(o=$(t.from)?t.from:1,r=t.levels,i={},e=j(t.defaults)?t.defaults:{},Y(r)&&(i=r.reduce((t,i)=>{let s,l,r;return j(i)&&$(i.level)&&(l=K((r=q({},i)).levelIsConstant,e.levelIsConstant),delete r.levelIsConstant,delete r.level,j(t[s=i.level+(l?0:o-1)])?q(!0,t[s],r):t[s]=r),t},{})),l=$(t.to)?t.to:1,s=0;s<=l;s++)a[s]=q({},e,j(i[s])?i[s]:{});return a},getNodeWidth:function(t,e){let{chart:i,options:s}=t,{nodeDistance:o=0,nodeWidth:l=0}=s,{plotSizeX:r=1}=i;if("auto"===l){if("string"==typeof o&&/%$/.test(o))return r/(e+parseFloat(o)/100*(e-1));let t=Number(o);return(r+t)/(e||1)-t}return Z(l,r)},setTreeValues:function t(e,i){let s=i.before,o=i.idRoot,l=i.mapIdToNode[o],r=!1!==i.levelIsConstant,a=i.points[e.i],n=a&&a.options||{},h=[],d=0;e.levelDynamic=e.level-(r?0:l.level),e.name=K(a&&a.name,""),e.visible=o===e.id||!0===i.visible,"function"==typeof s&&(e=s(e,i)),e.children.forEach((s,o)=>{let l=H({},i);H(l,{index:o,siblings:e.children.length,visible:e.visible}),s=t(s,l),h.push(s),s.visible&&(d+=s.val)});let p=K(n.value,d);return e.visible=p>=0&&(d>0||e.visible),e.children=h,e.childrenTotal=d,e.isLeaf=e.visible&&!d,e.val=p,e},updateRootId:function(t){let e,i;return j(t)&&(i=j(t.options)?t.options:{},e=K(t.rootNode,i.rootId,""),j(t.userOptions)&&(t.userOptions.rootId=e),t.rootNode=e),e}},{parse:J}=B(),{composed:Q,noop:tt}=l(),{column:te,scatter:ti}=S().seriesTypes,{getColor:ts,getLevelOptions:to,updateRootId:tl}=_,{addEvent:tr,arrayMax:ta,clamp:tn,correctFloat:th,crisp:td,defined:tp,error:tu,extend:tc,fireEvent:tg,isArray:tf,isNumber:tv,isObject:tm,isString:tb,merge:ty,pick:tx,pushUnique:tL,splat:tP,stableSort:tT}=l();M().keepProps.push("simulation","hadOutsideDataLabels");let tk=!1;function tw(){let t=this.xAxis,e=this.yAxis;if(t&&e)if(this.is("treemap")){let i={endOnTick:!1,startOnTick:!1,visible:!1};this.is("treegraph")||(i.min=0,i.max=100,i.tickPositions=[]),ty(!0,t.options,i,t.userOptions),ty(!0,e.options,i,e.userOptions),t.visible=t.options.visible,e.visible=e.options.visible,this.is("treegraph")&&(this.isCartesian=t.visible),tk=!0}else tk&&(e.setOptions(e.userOptions),t.setOptions(t.userOptions),tk=!1)}class tB extends ti{constructor(){super(...arguments),this.simulation=0}static compose(t){tL(Q,"TreemapSeries")&&tr(t,"afterBindAxes",tw)}algorithmCalcPoints(t,e,i,s){let o=i.plot,l=i.elArr.length-1,r,a,n,h,d=i.lW,p=i.lH,u,c=0;for(let t of(e?(d=i.nW,p=i.nH):u=i.elArr[l],i.elArr))(e||c<l)&&(0===i.direction?(r=o.x,a=o.y,h=t/(n=d)):(r=o.x,a=o.y,n=t/(h=p)),s.push({x:r,y:a,width:n,height:th(h)}),0===i.direction?o.y=o.y+h:o.x=o.x+n),c+=1;i.reset(),0===i.direction?i.width=i.width-d:i.height=i.height-p,o.y=o.parent.y+(o.parent.height-i.height),o.x=o.parent.x+(o.parent.width-i.width),t&&(i.direction=1-i.direction),e||i.addElement(u)}algorithmFill(t,e,i){let s=[],o,l=e.direction,r=e.x,a=e.y,n=e.width,h=e.height,d,p,u,c;for(let g of i)o=e.width*e.height*(g.val/e.val),d=r,p=a,0===l?(n-=u=o/(c=h),r+=u):(h-=c=o/(u=n),a+=c),s.push({x:d,y:p,width:u,height:c,direction:0,val:0}),t&&(l=1-l);return s}algorithmLowAspectRatio(t,e,i){let s=[],o={x:e.x,y:e.y,parent:e},l=e.direction,r=i.length-1,a=new R(e.height,e.width,l,o),n,h=0;for(let l of i)n=e.width*e.height*(l.val/e.val),a.addElement(n),a.lP.nR>a.lP.lR&&this.algorithmCalcPoints(t,!1,a,s,o),h===r&&this.algorithmCalcPoints(t,!0,a,s,o),++h;return s}alignDataLabel(t,e,i){te.prototype.alignDataLabel.apply(this,arguments),t.dataLabel&&t.dataLabel.attr({zIndex:(t.node.zIndex||0)+1})}applyTreeGrouping(){let t=this,e=t.parentList||{},{cluster:i}=t.options,s=i?.minimumClusterSize||5;if(i?.enabled){let o={},l=t=>{if(t?.point?.shapeArgs){let{width:e=0,height:s=0}=t.point.shapeArgs,{pixelWidth:l=0,pixelHeight:r=0}=i,a=tp(r),n=r?l*r:l*l;(e<l||s<(a?r:l)||e*s<n)&&!t.isGroup&&tp(t.parent)&&(o[t.parent]||(o[t.parent]=[]),o[t.parent].push(t))}t?.children.forEach(t=>{l(t)})};for(let r in l(t.tree),o)o[r]&&o[r].length>s&&o[r].forEach(s=>{let o=e[r].indexOf(s.i);if(-1!==o){e[r].splice(o,1);let l=`highcharts-grouped-treemap-points-${s.parent||"root"}`,a=t.points.find(t=>t.id===l);if(!a){let s=t.pointClass,o=t.points.length;tc(a=new s(t,{className:i.className,color:i.color,id:l,index:o,isGroup:!0,value:0}),{formatPrefix:"cluster"}),t.points.push(a),e[r].push(o),e[l]=[]}let n=a.groupedPointsAmount+1,h=t.points[a.index].options.value||0,d=i.name||`+ ${n}`;t.points[a.index].groupedPointsAmount=n,t.points[a.index].options.value=h+(s.point.value||0),t.points[a.index].name=d,e[l].push(s.point.index)}});t.nodeMap={},t.nodeList=[],t.parentList=e;let r=t.buildTree("",-1,0,t.parentList);t.translate(r)}}calculateChildrenAreas(t,e){let i=this.options,s=this.mapOptionsToLevel[t.level+1],o=tx(s?.layoutAlgorithm&&this[s?.layoutAlgorithm]&&s.layoutAlgorithm,i.layoutAlgorithm),l=i.alternateStartingDirection,r=t.children.filter(e=>t.isGroup||!e.ignore),a=s?.groupPadding??i.groupPadding??0,n=this.nodeMap[this.rootNode];if(!o)return;let h=[],d=n.pointValues?.width||0,p=n.pointValues?.height||0;s?.layoutStartingDirection&&(e.direction=+("vertical"!==s.layoutStartingDirection)),h=this[o](e,r);let u=-1;for(let t of r){let i=h[++u];t===n&&(d=d||i.width,p=i.height);let s=a/(this.xAxis.len/p),o=a/(this.yAxis.len/p);if(t.values=ty(i,{val:t.childrenTotal,direction:l?1-e.direction:e.direction}),t.children.length&&t.point.dataLabels?.length){let e=ta(t.point.dataLabels.map(t=>t.options?.headers&&t.height||0))/(this.yAxis.len/p);e<t.values.height/2&&(t.values.y+=e,t.values.height-=e)}if(a){let e=Math.min(s,t.values.width/4),i=Math.min(o,t.values.height/4);t.values.x+=e,t.values.width-=2*e,t.values.y+=i,t.values.height-=2*i}t.pointValues=ty(i,{x:i.x/this.axisRatio,y:100-i.y-i.height,width:i.width/this.axisRatio}),t.children.length&&this.calculateChildrenAreas(t,t.values)}let c=(t,e=[],i=!0)=>(t.children.forEach(t=>{i&&t.isLeaf?e.push(t.point):i||t.isLeaf||e.push(t.point),t.children.length&&c(t,e,i)}),e);if("leaf"===i.nodeSizeBy&&t===n&&this.hasOutsideDataLabels&&!c(n,void 0,!1).some(t=>tv(t.options.value))&&!tv(n.point?.options.value)){let i=c(n),s=i.map(t=>t.options.value||0),o=i.map(({node:{pointValues:t}})=>t?t.width*t.height:0),l=s.reduce((t,e)=>t+e,0),r=o.reduce((t,e)=>t+e,0)/l,a=0,h=0;i.forEach((t,e)=>{let i=tn((s[e]?o[e]/s[e]:1)/r,.8,1.4),l=1-i;t.value&&(o[e]<20&&(l*=o[e]/20),l>h&&(h=l),l<a&&(a=l),t.simulatedValue=(t.simulatedValue||t.value)/i)}),(a<-.05||h>.05)&&this.simulation<10?(this.simulation++,this.setTreeValues(t),e.val=t.val,this.calculateChildrenAreas(t,e)):(i.forEach(t=>{delete t.simulatedValue}),this.setTreeValues(t),this.simulation=0)}}createList(t){let e=this.chart,i=e.breadcrumbs,s=[];if(i){let i=0;s.push({level:i,levelOptions:e.series[0]});let o=t.target.nodeMap[t.newRootId],l=[];for(;o.parent||""===o.parent;)l.push(o),o=t.target.nodeMap[o.parent];for(let t of l.reverse())s.push({level:++i,levelOptions:t});s.length<=1&&(s.length=0)}return s}drawDataLabels(){let t=this.mapOptionsToLevel,e=this.points.filter(function(t){return t.node.visible||tp(t.dataLabel)}),i=tP(this.options.dataLabels||{})[0]?.padding,s=e.some(t=>tv(t.plotY));for(let o of e){let e={},l={style:e},r=t[o.node.level];if((!o.node.isLeaf&&!o.node.isGroup||o.node.isGroup&&o.node.level<=this.nodeMap[this.rootNode].level)&&(l.enabled=!1),r?.dataLabels&&(ty(!0,l,tP(r.dataLabels)[0]),this.hasDataLabels=()=>!0),o.node.isLeaf?l.inside=!0:l.headers&&(l.verticalAlign="top"),o.shapeArgs&&s){let{height:t=0,width:s=0}=o.shapeArgs;if(s>32&&t>16&&o.shouldDraw()){let r=s-2*(l.padding||i||0);e.width=`${r}px`,e.lineClamp??(e.lineClamp=Math.floor(t/16)),e.visibility="inherit",l.headers&&o.dataLabel?.attr({width:r})}else e.width=`${s}px`,e.visibility="hidden"}o.dlOptions=ty(l,o.options.dataLabels,{zIndex:void 0})}super.drawDataLabels(e)}drawPoints(t=this.points){let e=this.chart,i=e.renderer,s=e.styledMode,o=this.options,l=s?{}:o.shadow,r=o.borderRadius,a=e.pointCount<o.animationLimit,n=o.allowTraversingTree;for(let e of t){let t={},h={},d={},p="level-group-"+e.node.level,u=!!e.graphic,c=a&&u,g=e.shapeArgs;e.shouldDraw()&&(e.isInside=!0,r&&(h.r=r),ty(!0,c?t:h,u?g:{},s?{}:this.pointAttribs(e,e.selected?"select":void 0)),this.colorAttribs&&s&&tc(d,this.colorAttribs(e)),this[p]||(this[p]=i.g(p).attr({zIndex:-(e.node.level||0)}).add(this.group),this[p].survive=!0)),e.draw({animatableAttribs:t,attribs:h,css:d,group:this[p],imageUrl:e.imageUrl,renderer:i,shadow:l,shapeArgs:g,shapeType:e.shapeType}),n&&e.graphic&&(e.drillId=o.interactByLeaf?this.drillToByLeaf(e):this.drillToByGroup(e))}}drillToByGroup(t){return(!t.node.isLeaf||!!t.node.isGroup)&&t.id}drillToByLeaf(t){let{traverseToLeaf:e}=t.series.options,i=!1,s;if(t.node.parent!==this.rootNode&&t.node.isLeaf)if(e)i=t.id;else for(s=t.node;!i;)void 0!==s.parent&&(s=this.nodeMap[s.parent]),s.parent===this.rootNode&&(i=s.id);return i}drillToNode(t,e){tu(32,!1,void 0,{"treemap.drillToNode":"use treemap.setRootNode"}),this.setRootNode(t,e)}drillUp(){let t=this.nodeMap[this.rootNode];t&&tb(t.parent)&&this.setRootNode(t.parent,!0,{trigger:"traverseUpButton"})}getExtremes(){let{dataMin:t,dataMax:e}=super.getExtremes(this.colorValueData);return this.valueMin=t,this.valueMax=e,super.getExtremes()}getListOfParents(t,e){let i=tf(t)?t:[],s=tf(e)?e:[],o=i.reduce(function(t,e,i){let s=tx(e.parent,"");return void 0===t[s]&&(t[s]=[]),t[s].push(i),t},{"":[]});for(let t of Object.keys(o)){let e=o[t];if(""!==t&&-1===s.indexOf(t)){for(let t of e)o[""].push(t);delete o[t]}}return o}getTree(){let t=this.data.map(function(t){return t.id});return this.parentList=this.getListOfParents(this.data,t),this.nodeMap={},this.nodeList=[],this.buildTree("",-1,0,this.parentList||{})}buildTree(t,e,i,s,o){let l=[],r=this.points[e],a=0,n;for(let e of s[t]||[])a=Math.max((n=this.buildTree(this.points[e].id,e,i+1,s,t)).height+1,a),l.push(n),this.is("treegraph")&&(n.visible=!0);let h=new this.NodeClass().init(t,e,l,a,i,this,o);for(let t of l)t.parentNode=h;return this.nodeMap[h.id]=h,this.nodeList.push(h),r&&(r.node=h,h.point=r,tp(r.options.x)||(r.x=i)),h}hasData(){return!!this.dataTable.rowCount}init(t,e){let i=this,s=ty(e.drillUpButton,e.breadcrumbs),o=tr(i,"setOptions",t=>{let e=t.userOptions;tp(e.allowDrillToNode)&&!tp(e.allowTraversingTree)&&(e.allowTraversingTree=e.allowDrillToNode,delete e.allowDrillToNode),tp(e.drillUpButton)&&!tp(e.traverseUpButton)&&(e.traverseUpButton=e.drillUpButton,delete e.drillUpButton);let i=tP(e.dataLabels||{});e.levels?.forEach(t=>{i.push.apply(i,tP(t.dataLabels||{}))}),this.hasOutsideDataLabels=i.some(t=>t.headers)});super.init(t,e),delete i.opacity,i.eventsToUnbind.push(o),i.options.allowTraversingTree&&(i.eventsToUnbind.push(tr(i,"click",i.onClickDrillToNode)),i.eventsToUnbind.push(tr(i,"setRootNode",function(t){let e=i.chart;e.breadcrumbs&&e.breadcrumbs.updateProperties(i.createList(t))})),i.eventsToUnbind.push(tr(i,"update",function(t,e){let i=this.chart.breadcrumbs;i&&t.options.breadcrumbs&&i.update(t.options.breadcrumbs),this.hadOutsideDataLabels=this.hasOutsideDataLabels})),i.eventsToUnbind.push(tr(i,"destroy",function(t){let e=this.chart;e.breadcrumbs&&!t.keepEventsForUpdate&&(e.breadcrumbs.destroy(),e.breadcrumbs=void 0)}))),t.breadcrumbs||(t.breadcrumbs=new k(t,s)),i.eventsToUnbind.push(tr(t.breadcrumbs,"up",function(t){let e=this.level-t.newLevel;for(let t=0;t<e;t++)i.drillUp()}))}onClickDrillToNode(t){let e=t.point,i=e?.drillId;tb(i)&&(e.setState(""),this.setRootNode(i,!0,{trigger:"click"}))}pointAttribs(t,e){let i=tm(this.mapOptionsToLevel)?this.mapOptionsToLevel:{},s=t&&i[t.node.level]||{},o=this.options,l=e&&o.states&&o.states[e]||{},r=t?.getClassName()||"",a={stroke:t&&t.borderColor||s.borderColor||l.borderColor||o.borderColor,"stroke-width":tx(t&&t.borderWidth,s.borderWidth,l.borderWidth,o.borderWidth),dashstyle:t?.borderDashStyle||s.borderDashStyle||l.borderDashStyle||o.borderDashStyle,fill:t?.color||this.color};return -1!==r.indexOf("highcharts-above-level")?(a.fill="none",a["stroke-width"]=0):-1!==r.indexOf("highcharts-internal-node-interactive")?(a["fill-opacity"]=l.opacity??o.opacity??1,a.cursor="pointer"):-1!==r.indexOf("highcharts-internal-node")?a.fill="none":e&&l.brightness&&(a.fill=J(a.fill).brighten(l.brightness).get()),a}setColorRecursive(t,e,i,s,o){let l=this?.chart,r=l?.options?.colors;if(t){let l=ts(t,{colors:r,index:s,mapOptionsToLevel:this.mapOptionsToLevel,parentColor:e,parentColorIndex:i,series:this,siblings:o}),a=this.points[t.i];a&&(a.color=l.color,a.colorIndex=l.colorIndex);let n=-1;for(let e of t.children||[])this.setColorRecursive(e,l.color,l.colorIndex,++n,t.children.length)}}setPointValues(){let t=this,{points:e,xAxis:i,yAxis:s}=t,o=t.chart.styledMode,l=e=>o?0:t.pointAttribs(e)["stroke-width"]||0;for(let t of e){let{pointValues:e,visible:o}=t.node;if(e&&o){let{height:o,width:r,x:a,y:n}=e,h=l(t),d=i.toPixels(a,!0),p=i.toPixels(a+r,!0),u=s.toPixels(n,!0),c=s.toPixels(n+o,!0),g=0===d?h/2:td(i.toPixels(a,!0),h,!0),f=p===i.len?i.len-h/2:td(i.toPixels(a+r,!0),h,!0),v=u===s.len?s.len-h/2:td(s.toPixels(n,!0),h,!0),m=0===c?h/2:td(s.toPixels(n+o,!0),h,!0),b={x:Math.min(g,f),y:Math.min(v,m),width:Math.abs(f-g),height:Math.abs(m-v)};t.plotX=b.x+b.width/2,t.plotY=b.y+b.height/2,t.shapeArgs=b}else delete t.plotX,delete t.plotY}}setRootNode(t,e,i){tg(this,"setRootNode",tc({newRootId:t,previousRootId:this.rootNode,redraw:tx(e,!0),series:this},i),function(t){let e=t.series;e.idPreviousRoot=t.previousRootId,e.rootNode=t.newRootId,e.isDirty=!0,t.redraw&&e.chart.redraw()})}setState(t){this.options.inactiveOtherPoints=!0,super.setState(t,!1),this.options.inactiveOtherPoints=!1}setTreeValues(t){let e=this.options,i=this.rootNode,s=this.nodeMap[i],o="boolean"!=typeof e.levelIsConstant||e.levelIsConstant,l=[],r=this.points[t.i],a=0;for(let e of t.children)e=this.setTreeValues(e),l.push(e),e.ignore||(a+=e.val);tT(l,(t,e)=>(t.sortIndex||0)-(e.sortIndex||0));let n=tx(r?.simulatedValue,r?.options.value,a);return r&&(r.value=n),r?.isGroup&&e.cluster?.reductionFactor&&(n/=e.cluster.reductionFactor),t.parentNode?.point?.isGroup&&this.rootNode!==t.parent&&(t.visible=!1),tc(t,{children:l,childrenTotal:a,ignore:!(tx(r?.visible,!0)&&n>0),isLeaf:t.visible&&!("treegraph"===this.type?l.length>0:a),isGroup:r?.isGroup,levelDynamic:t.level-(o?0:s.level),name:tx(r?.name,""),sortIndex:tx(r?.sortIndex,-n),val:n}),t}sliceAndDice(t,e){return this.algorithmFill(!0,t,e)}squarified(t,e){return this.algorithmLowAspectRatio(!0,t,e)}strip(t,e){return this.algorithmLowAspectRatio(!1,t,e)}stripes(t,e){return this.algorithmFill(!1,t,e)}translate(t){let e=this,i=e.options,s=!t,o=tl(e),l,r,a,n;t||o.startsWith("highcharts-grouped-treemap-points-")||((this.points||[]).forEach(t=>{t.isGroup&&t.destroy()}),super.translate(),t=e.getTree()),e.tree=t=t||e.tree,l=e.nodeMap[o],""===o||l||(e.setRootNode("",!1),o=e.rootNode,l=e.nodeMap[o]),l.point?.isGroup||(e.mapOptionsToLevel=to({from:l.level+1,levels:i.levels,to:t.height,defaults:{levelIsConstant:e.options.levelIsConstant,colorByPoint:i.colorByPoint}})),F.recursive(e.nodeMap[e.rootNode],t=>{let i=t.parent,s=!1;return t.visible=!0,(i||""===i)&&(s=e.nodeMap[i]),s}),F.recursive(e.nodeMap[e.rootNode].children,t=>{let e=!1;for(let i of t)i.visible=!0,i.children.length&&(e=(e||[]).concat(i.children));return e}),e.setTreeValues(t),e.axisRatio=e.xAxis.len/e.yAxis.len,e.nodeMap[""].pointValues=r={x:0,y:0,width:100,height:100},e.nodeMap[""].values=a=ty(r,{width:r.width*e.axisRatio,direction:+("vertical"!==i.layoutStartingDirection),val:t.val}),(this.hasOutsideDataLabels||this.hadOutsideDataLabels)&&this.drawDataLabels(),e.calculateChildrenAreas(t,a),e.colorAxis||i.colorByPoint||e.setColorRecursive(e.tree),i.allowTraversingTree&&l.pointValues&&(n=l.pointValues,e.xAxis.setExtremes(n.x,n.x+n.width,!1),e.yAxis.setExtremes(n.y,n.y+n.height,!1),e.xAxis.setScale(),e.yAxis.setScale()),e.setPointValues(),s&&e.applyTreeGrouping()}}tB.defaultOptions=ty(ti.defaultOptions,z),tc(tB.prototype,{buildKDTree:tt,colorAttribs:A().seriesMembers.colorAttribs,colorKey:"colorValue",directTouch:!0,getExtremesFromAll:!0,getSymbol:tt,optionalAxis:"colorAxis",parallelArrays:["x","y","value","colorValue"],pointArrayMap:["value","colorValue"],pointClass:U,NodeClass:class{constructor(){this.childrenTotal=0,this.visible=!1}init(t,e,i,s,o,l,r){return this.id=t,this.i=e,this.children=i,this.height=s,this.level=o,this.series=l,this.parent=r,this}},trackerGroups:["group","dataLabelsGroup"],utils:F}),A().compose(tB),S().registerSeriesType("treemap",tB);/**
 * @license Highcharts JS v12.4.0-modified (2025-11-13)
 * @module highcharts/modules/treemap
 * @requires highcharts
 *
 * (c) 2014-2025 Highsoft AS
 * Authors: Jon Arild Nygard / Oystein Moseng
 *
 * License: www.highcharts.com/license
 */let tC=l();function tA(t){let{x1:e,y1:i,x2:s,y2:o,bendAt:l,width:r=0,inverted:a=!1,radius:n,parentVisible:h}=t;if(h){let t=l??r/2;return tO([["M",e,i],["L",e+t*(a?-1:1),i],["L",e+t*(a?-1:1),o],["L",s,o]],n)}return[["M",e,i],["L",e,i],["C",e,i,e,o,e,o],["L",e,o],["C",e,i,e,o,e,o],["L",e,o]]}function tO(t,e){let i=[];for(let s=0;s<t.length;s++){let o=t[s][1],l=t[s][2];if("number"==typeof o&&"number"==typeof l)if(0===s)i.push(["M",o,l]);else if(s===t.length-1)i.push(["L",o,l]);else if(e){let r=t[s-1],a=t[s+1];if(r&&a){let t=r[1],s=r[2],n=a[1],h=a[2];if("number"==typeof t&&"number"==typeof n&&"number"==typeof s&&"number"==typeof h&&t!==n&&s!==h){let r=t<n?1:-1,a=s<h?1:-1;i.push(["L",o-r*Math.min(Math.abs(o-t),e),l-a*Math.min(Math.abs(l-s),e)],["C",o,l,o,l,o+r*Math.min(Math.abs(o-n),e),l+a*Math.min(Math.abs(l-h),e)])}}}else i.push(["L",o,l])}return i}tC.Breadcrumbs=tC.Breadcrumbs||k,tC.Breadcrumbs.compose(tC.Chart,tC.defaultOptions),tB.compose(tC.Series);let tM=t.default.SVGRenderer;var tN=s.n(tM);let{seriesTypes:{treemap:{prototype:{NodeClass:tS}}}}=S(),tR=class extends tS{constructor(){super(...arguments),this.mod=0,this.shift=0,this.change=0,this.children=[],this.preX=0,this.hidden=!1,this.wasVisited=!1,this.collapsed=!1}nextLeft(){return this.getLeftMostChild()||this.thread}nextRight(){return this.getRightMostChild()||this.thread}getAncestor(t,e){return t.ancestor.children[0]===this.children[0]?t.ancestor:e}getLeftMostSibling(){let t=this.getParent();if(t){for(let e of t.children)if(e&&e.point.visible)return e}}hasChildren(){let t=this.children;for(let e=0;e<t.length;e++)if(t[e].point.visible)return!0;return!1}getLeftSibling(){let t=this.getParent();if(t){let e=t.children;for(let t=this.relativeXPosition-1;t>=0;t--)if(e[t]&&e[t].point.visible)return e[t]}}getLeftMostChild(){let t=this.children;for(let e=0;e<t.length;e++)if(t[e].point.visible)return t[e]}getRightMostChild(){let t=this.children;for(let e=t.length-1;e>=0;e--)if(t[e].point.visible)return t[e]}getParent(){return this.parentNode}getFirstChild(){let t=this.children;for(let e=0;e<t.length;e++)if(t[e].point.visible)return t[e]}},tD=t.default.Point;var tI=s.n(tD);let{seriesTypes:{treemap:{prototype:{pointClass:tW}}}}=S(),{addEvent:tX,fireEvent:tE,merge:tV}=l();class tU extends tW{constructor(){super(...arguments),this.dataLabelOnHidden=!0,this.isLink=!1,this.setState=tI().prototype.setState}draw(){super.draw.apply(this,arguments);let t=this.graphic;t&&t.animate({visibility:this.visible?"inherit":"hidden"}),this.renderCollapseButton()}renderCollapseButton(){let t=this.series,e=this.graphic&&this.graphic.parentGroup,i=t.mapOptionsToLevel[this.node.level||0]||{},s=tV(t.options.collapseButton,i.collapseButton,this.options.collapseButton),{width:o,height:l,shape:r,style:a}=s,n=this.series.chart,h=this.visible&&(this.collapsed||!s.onlyOnHover||"hover"===this.state)?1:0;if(this.shapeArgs)if(this.collapseButtonOptions=s,this.collapseButton)if(this.node.children.length&&s.enabled){let{x:t,y:e}=this.getCollapseBtnPosition(s);this.collapseButton.attr({text:this.collapsed?"+":"-",rotation:90*!!n.inverted,rotationOriginX:o/2,rotationOriginY:l/2,visibility:this.visible?"inherit":"hidden"}).animate({x:t,y:e,opacity:h})}else this.collapseButton.destroy(),delete this.collapseButton;else{if(!this.node.children.length||!s.enabled)return;let{x:t,y:i}=this.getCollapseBtnPosition(s),d=s.fillColor||this.color||"#cccccc";this.collapseButton=n.renderer.label(this.collapsed?"+":"-",t,i,r).attr({height:l-4,width:o-4,padding:2,fill:d,rotation:90*!!n.inverted,rotationOriginX:o/2,rotationOriginY:l/2,stroke:s.lineColor||"#ffffff","stroke-width":s.lineWidth,"text-align":"center",align:"center",zIndex:1,opacity:h,visibility:this.visible?"inherit":"hidden"}).addClass("highcharts-tracker").addClass("highcharts-collapse-button").removeClass("highcharts-no-tooltip").css(tV({color:"string"==typeof d?n.renderer.getContrast(d):"#333333"},a)).add(e),this.collapseButton.element.point=this}}toggleCollapse(t){let e=this.series;this.update({collapsed:t??!this.collapsed},!1,void 0,!1),tE(e,"toggleCollapse"),e.redraw()}destroy(){this.collapseButton&&(this.collapseButton.destroy(),delete this.collapseButton,this.collapseButton=void 0),this.linkToParent&&(this.linkToParent.destroy(),delete this.linkToParent),super.destroy.apply(this,arguments)}getCollapseBtnPosition(t){let e=this.series.chart.inverted,i=t.width,s=t.height,{x:o=0,y:l=0,width:r=0,height:a=0}=this.shapeArgs||{};return{x:o+t.x+(e?-(.3*s):r+-.3*i),y:l+a/2-s/2+t.y}}}tX(tU,"mouseOut",function(){let t=this.collapseButton,e=this.collapseButtonOptions;t&&e?.onlyOnHover&&!this.collapsed&&t.animate({opacity:0})}),tX(tU,"mouseOver",function(){this.collapseButton&&this.visible&&this.collapseButton.animate({opacity:1},this.series.options.states?.hover?.animation)}),tX(tU,"click",function(){this.toggleCollapse()});let{pick:tG,extend:tz}=l(),{seriesTypes:{column:{prototype:{pointClass:tF}}}}=S(),tH=class extends tF{constructor(t,e,i,s){super(t,e,i),this.dataLabelOnNull=!0,this.formatPrefix="link",this.isLink=!0,this.node={},this.formatPrefix="link",this.dataLabelOnNull=!0,s&&(this.fromNode=s.node.parentNode.point,this.visible=s.visible,this.toNode=s,this.id=this.toNode.id+"-"+this.fromNode.id)}update(t,e,i,s){let o={id:this.id,formatPrefix:this.formatPrefix};tI().prototype.update.call(this,t,!this.isLink&&e,i,s),this.visible=this.toNode.visible,tz(this,o),tG(e,!0)&&this.series.chart.redraw(i)}};class tY{static createDummyNode(t,e,i){let s=new tR;return s.id=t.id+"-"+i,s.ancestor=t,s.children.push(e),s.parent=t.id,s.parentNode=t,s.point=e.point,s.level=e.level-i,s.relativeXPosition=e.relativeXPosition,s.visible=e.visible,t.children[e.relativeXPosition]=s,e.oldParentNode=t,e.relativeXPosition=0,e.parentNode=s,e.parent=s.id,s}calculatePositions(t){let e=t.nodeList;this.resetValues(e);let i=t.tree;i&&(this.calculateRelativeX(i,0),this.beforeLayout(e),this.firstWalk(i),this.secondWalk(i,-i.preX),this.afterLayout(e))}beforeLayout(t){for(let e of t)for(let t of e.children)if(t&&t.level-e.level>1){let i=t.level-e.level-1;for(;i>0;)t=tY.createDummyNode(e,t,i),i--}}resetValues(t){for(let e of t)e.mod=0,e.ancestor=e,e.shift=0,e.thread=void 0,e.change=0,e.preX=0}calculateRelativeX(t,e){let i=t.children;for(let t=0,e=i.length;t<e;++t)this.calculateRelativeX(i[t],t);t.relativeXPosition=e}firstWalk(t){let e;if(t.hasChildren()){let i=t.getLeftMostChild();for(let e of t.children)this.firstWalk(e),i=this.apportion(e,i);this.executeShifts(t);let s=t.getLeftMostChild(),o=t.getRightMostChild(),l=(s.preX+o.preX)/2;(e=t.getLeftSibling())?(t.preX=e.preX+1,t.mod=t.preX-l):t.preX=l}else(e=t.getLeftSibling())?(t.preX=e.preX+1,t.mod=t.preX):t.preX=0}secondWalk(t,e){for(let i of(t.yPosition=t.preX+e,t.xPosition=t.point?.x??t.level,t.children))this.secondWalk(i,e+t.mod)}executeShifts(t){let e=0,i=0;for(let s=t.children.length-1;s>=0;s--){let o=t.children[s];o.preX+=e,o.mod+=e,i+=o.change,e+=o.shift+i}}apportion(t,e){let i=t.getLeftSibling();if(i){let s=t,o=t,l=i,r=s.getLeftMostSibling(),a=s.mod,n=o.mod,h=l.mod,d=r.mod;for(;l&&l.nextRight()&&s&&s.nextLeft();){l=l.nextRight(),r=r.nextLeft(),s=s.nextLeft(),(o=o.nextRight()).ancestor=t;let i=l.preX+h-(s.preX+a)+1;i>0&&(this.moveSubtree(t.getAncestor(l,e),t,i),a+=i,n+=i),h+=l.mod,a+=s.mod,d+=r.mod,n+=o.mod}l&&l.nextRight()&&!o.nextRight()&&(o.thread=l.nextRight(),o.mod+=h-n),s&&s.nextLeft()&&!r.nextLeft()&&(r.thread=s.nextLeft(),r.mod+=a-d),e=t}return e}moveSubtree(t,e,i){let s=e.relativeXPosition-t.relativeXPosition;e.change-=i/s,e.shift+=i,e.preX+=i,e.mod+=i,t.change+=i/s}afterLayout(t){for(let e of t)e.oldParentNode&&(e.relativeXPosition=e.parentNode.relativeXPosition,e.parent=e.oldParentNode.parent,e.parentNode=e.oldParentNode,e.oldParentNode.children.splice(e.relativeXPosition,1,e),e.oldParentNode=void 0)}}let t$=t.default.SVGElement;var tj=s.n(t$);let{deg2rad:tq}=l(),{addEvent:tK,merge:tZ,uniqueKey:t_,defined:tJ,extend:tQ}=l();function t0(t,e){e=tZ(!0,{enabled:!0,attributes:{dy:-5,startOffset:"50%",textAnchor:"middle"}},e);let i=this.renderer.url,s=this.text||this,o=s.textPath,{attributes:l,enabled:r}=e;if(t=t||o&&o.path,o&&o.undo(),t&&r){let e=tK(s,"afterModifyTree",e=>{if(t&&r){let o=t.attr("id");o||t.attr("id",o=t_());let r={x:0,y:0};tJ(l.dx)&&(r.dx=l.dx,delete l.dx),tJ(l.dy)&&(r.dy=l.dy,delete l.dy),s.attr(r),this.attr({transform:""}),this.box&&(this.box=this.box.destroy());let a=e.nodes.slice(0);e.nodes.length=0,e.nodes[0]={tagName:"textPath",attributes:tQ(l,{"text-anchor":l.textAnchor,href:`${i}#${o}`}),children:a}}});s.textPath={path:t,undo:e}}else s.attr({dx:0,dy:0}),delete s.textPath;return this.added&&(s.textCache="",this.renderer.buildText(s)),this}function t1(t){let e=t.bBox,i=this.element?.querySelector("textPath");if(i){let t=[],{b:s,h:o}=this.renderer.fontMetrics(this.element),l=o-s,r=RegExp('(<tspan>|<tspan(?!\\sclass="highcharts-br")[^>]*>|<\\/tspan>)',"g"),a=i.innerHTML.replace(r,"").split(/<tspan class="highcharts-br"[^>]*>/),n=a.length,h=(t,e)=>{let{x:o,y:r}=e,a=(i.getRotationOfChar(t)-90)*tq,n=Math.cos(a),h=Math.sin(a);return[[o-l*n,r-l*h],[o+s*n,r+s*h]]};for(let e=0,s=0;s<n;s++){let o=a[s].length;for(let l=0;l<o;l+=5)try{let o=e+l+s,[r,a]=h(o,i.getStartPositionOfChar(o));0===l?(t.push(a),t.push(r)):(0===s&&t.unshift(a),s===n-1&&t.push(r))}catch{break}e+=o-1;try{let o=e+s,l=i.getEndPositionOfChar(o),[r,a]=h(o,l);t.unshift(a),t.unshift(r)}catch{break}}t.length&&t.push(t[0].slice()),e.polygon=t}return e}function t2(t){let e=t.labelOptions,i=t.point,s=e[i.formatPrefix+"TextPath"]||e.textPath;s&&!e.useHTML&&(this.setTextPath(i.getDataLabelPath?.(this)||i.graphic,s),i.dataLabelPath&&!s.enabled&&(i.dataLabelPath=i.dataLabelPath.destroy()))}let{getLinkPath:t6}={applyRadius:tO,getLinkPath:{default:tA,orthogonal:tA,straight:function(t){let{x1:e,y1:i,x2:s,y2:o,width:l=0,inverted:r=!1,parentVisible:a}=t;return a?[["M",e,i],["L",e+l*(r?-1:1),o],["L",s,o]]:[["M",e,i],["L",e,o],["L",e,o]]},curved:function(t){let{x1:e,y1:i,x2:s,y2:o,offset:l=0,width:r=0,inverted:a=!1,parentVisible:n}=t;return n?[["M",e,i],["C",e+l,i,e-l+r*(a?-1:1),o,e+r*(a?-1:1),o],["L",s,o]]:[["M",e,i],["C",e,i,e,o,e,o],["L",s,o]]}}},{series:{prototype:t5},seriesTypes:{treemap:t3,column:t9}}=S(),{prototype:{symbols:t4}}=tN(),{getLevelOptions:t8,getNodeWidth:t7}=_,{arrayMax:et,crisp:ee,extend:ei,merge:es,pick:eo,relativeLength:el,splat:er}=l();({compose:function(t){tK(t,"afterGetBBox",t1),tK(t,"beforeAddingDataLabel",t2);let e=t.prototype;e.setTextPath||(e.setTextPath=t0)}}).compose(tj());class ea extends t3{constructor(){super(...arguments),this.nodeList=[],this.links=[]}init(){super.init.apply(this,arguments),this.layoutAlgorythm=new tY;let t=this,e=this.chart.labelCollectors;e.some(t=>"collectorFunc"===t.name)||e.push(function(){let e=[];if(t.options.dataLabels&&!er(t.options.dataLabels)[0].allowOverlap)for(let i of t.links||[])i.dataLabel&&e.push(i.dataLabel);return e})}getLayoutModifiers(){let t=this.chart,e=this,i=t.plotSizeX,s=t.plotSizeY,o=e.options.link?.lineWidth||0,l=et(this.points.map(t=>t.node.xPosition)),r=1/0,a=-1/0,n=1/0,h=-1/0,d=0,p=0,u=0,c=0;this.points.forEach(t=>{if(this.options.fillSpace&&!t.visible)return;let g=t.node,f=e.mapOptionsToLevel[t.node.level]||{},v=es(this.options.marker,f.marker,t.options.marker),m=v.width??t7(this,l),b=el(v.radius||0,Math.min(i,s)),y=Math.max(v.lineWidth||0,o),x=v.symbol,L="circle"!==x&&v.height?el(v.height,s):2*b,P="circle"!==x&&m?el(m,i):2*b;g.nodeSizeX=P,g.nodeSizeY=L,g.xPosition<=r&&(r=g.xPosition,p=Math.max(P+y,p)),g.xPosition>=a&&(a=g.xPosition,d=Math.max(P+y,d)),g.yPosition<=n&&(n=g.yPosition,c=Math.max(L+y,c)),g.yPosition>=h&&(h=g.yPosition,u=Math.max(L+y,u))});let g=h===n?1:(s-(c+u)/2)/(h-n),f=h===n?s/2:-g*n+c/2,v=a===r?1:(i-(d+d)/2)/(a-r),m=a===r?i/2:-v*r+p/2;return{ax:v,bx:m,ay:g,by:f}}getLinks(){let t=this,e=[];return this.data.forEach(i=>{let s=t.mapOptionsToLevel[i.node.level??0]||{};if(i.node.parent){let o=es(s,i.options);if(!i.linkToParent||i.linkToParent.destroyed){let e=new t.LinkClass(t,o,void 0,i);i.linkToParent=e}else i.collapsed=eo(i.collapsed,(this.mapOptionsToLevel[i.node.level]||{}).collapsed),i.linkToParent.visible=i.linkToParent.toNode.visible;i.linkToParent.index=e.push(i.linkToParent)-1}else i.linkToParent&&(t.links.splice(i.linkToParent.index),i.linkToParent.destroy(),delete i.linkToParent)}),e}buildTree(t,e,i,s,o){let l=this.points[e];return i=l?.level??i,super.buildTree.call(this,t,e,i,s,o)}markerAttribs(){return{}}setCollapsedStatus(t,e){let i=t.point;i&&(i.collapsed=eo(i.collapsed,(this.mapOptionsToLevel[t.level]||{}).collapsed),i.visible=e,e=!1!==e&&!i.collapsed),t.children.forEach(t=>{this.setCollapsedStatus(t,e)})}drawTracker(){t9.prototype.drawTracker.apply(this,arguments),t9.prototype.drawTracker.call(this,this.links)}translate(){let t=this.options,e=_.updateRootId(this),i;t5.translate.call(this);let s=this.tree=this.getTree();i=this.nodeMap[e],""===e||i&&i.children.length||(this.setRootNode("",!1),e=this.rootNode,i=this.nodeMap[e]),this.mapOptionsToLevel=t8({from:i.level+1,levels:t.levels,to:s.height,defaults:{levelIsConstant:this.options.levelIsConstant,colorByPoint:t.colorByPoint}}),this.setCollapsedStatus(s,!0),this.links=this.getLinks(),this.setTreeValues(s),this.layoutAlgorythm.calculatePositions(this),this.layoutModifier=this.getLayoutModifiers(),this.points.forEach(t=>{this.translateNode(t)}),this.points.forEach(t=>{t.linkToParent&&this.translateLink(t.linkToParent)}),t.colorByPoint||this.setColorRecursive(this.tree)}translateLink(t){let e=t.fromNode,i=t.toNode,s=this.options.link?.lineWidth||0,o=eo(this.options.link?.curveFactor,.5),l=i.x!==i.node.level||e.x!==e.node.level,r=eo(t.options.link?.type,this.options.link?.type,"default");if(e.shapeArgs&&i.shapeArgs){let a=e.shapeArgs.width||0,n=this.chart.inverted,h=ee((e.shapeArgs.y||0)+(e.shapeArgs.height||0)/2,s),d=ee((i.shapeArgs.y||0)+(i.shapeArgs.height||0)/2,s),p=ee((e.shapeArgs.x||0)+a,s),u=ee(i.shapeArgs.x||0,s);n&&(p-=Math.round(a),u+=Math.round(i.shapeArgs.width||0));let c=i.node.xPosition-e.node.xPosition,g=Math.abs(u-p)+a,f=(l?g:g/c)-a,v=ee((u+p)/2,s),m=el(t.options.link?.bendAt??this.options.link?.bendAt??"50%",g-a);t.shapeType="path",t.plotX=v,t.plotY=d,t.shapeArgs={d:t6[r]({x1:p,y1:h,x2:u,y2:d,width:f,offset:f*o*(n?-1:1),inverted:n,parentVisible:i.visible,radius:this.options.link?.radius,bendAt:m})},t.dlBox={x:(p+u)/2,y:(h+d)/2,height:s,width:0},t.tooltipPos=n?[(this.chart.plotSizeY||0)-t.dlBox.y,(this.chart.plotSizeX||0)-t.dlBox.x]:[t.dlBox.x,t.dlBox.y]}}drawNodeLabels(t){let e,i,s=this.mapOptionsToLevel;for(let o of t){if(i=s[o.node.level],e={style:{}},i&&i.dataLabels&&(e=es(e,i.dataLabels),this.hasDataLabels=()=>!0),o.shapeArgs&&this.options.dataLabels){let t={},{width:i=0,height:s=0}=o.shapeArgs;this.chart.inverted&&([i,s]=[s,i]),er(this.options.dataLabels)[0].style?.width||(t.width=`${i}px`),er(this.options.dataLabels)[0].style?.lineClamp||(t.lineClamp=Math.floor(s/16)),ei(e.style,t),o.dataLabel?.css(t)}o.dlOptions=es(e,o.options.dataLabels)}t5.drawDataLabels.call(this,t)}alignDataLabel(t,e){let i=t.visible;t.visible=!0,super.alignDataLabel.apply(this,arguments),e.animate({opacity:+(!1!==i)},void 0,function(){i||e.hide()}),t.visible=i}drawDataLabels(){this.options.dataLabels&&(this.options.dataLabels=er(this.options.dataLabels),this.drawNodeLabels(this.points),t5.drawDataLabels.call(this,this.links))}destroy(){if(this.links){for(let t of this.links)t.destroy();this.links.length=0}return t5.destroy.apply(this,arguments)}pointAttribs(t,e){let i=t&&this.mapOptionsToLevel[t.node.level??0]||{},s=t&&t.options,o=i.states&&i.states[e]||{};t&&(t.options.marker=es(this.options.marker,i.marker,t.options.marker));let l=eo(o&&o.link&&o.link.color,s&&s.link&&s.link.color,i&&i.link&&i.link.color,this.options.link&&this.options.link.color),r=eo(o&&o.link&&o.link.lineWidth,s&&s.link&&s.link.lineWidth,i&&i.link&&i.link.lineWidth,this.options.link&&this.options.link.lineWidth),a=t5.pointAttribs.call(this,t,e);return t&&(t.isLink&&(a.stroke=l,a["stroke-width"]=r,delete a.fill),t.visible||(a.opacity=0)),a}drawPoints(){t3.prototype.drawPoints.apply(this,arguments),t9.prototype.drawPoints.call(this,this.links)}translateNode(t){let e=this.chart,{node:i,plotX:s=0}=t,o=e.plotSizeY,l=e.plotSizeX,{ax:r,bx:a,ay:n,by:h}=this.layoutModifier,d=this.isCartesian?e.inverted?l-s:s:r*i.xPosition+a,p=n*i.yPosition+h,u=this.mapOptionsToLevel[i.level]||{},c=es(this.options.marker,u.marker,t.options.marker).symbol,g=i.nodeSizeY,f=i.nodeSizeX,v=this.options.reversed,m=i.x=e.inverted?l-f/2-d:d-f/2,b=i.y=v?p-g/2:o-p-g/2,y=eo(t.options.borderRadius,u.borderRadius,this.options.borderRadius),x=t4[c||"circle"];if(void 0===x?(t.hasImage=!0,t.shapeType="image",t.imageUrl=c.match(/^url\((.*?)\)$/)[1]):t.shapeType="path",!t.visible&&t.linkToParent){let e=t.linkToParent.fromNode;if(e){let{x:i=0,y:s=0,width:o=0,height:l=0}=e.shapeArgs||{};t.shapeArgs||(t.shapeArgs={}),t.hasImage||ei(t.shapeArgs,{d:x(i,s,o,l,y?{r:y}:void 0)}),ei(t.shapeArgs,{x:i,y:s}),t.plotX=e.plotX,t.plotY=e.plotY}}else t.plotX=m,t.plotY=b,t.shapeArgs={x:m,y:b,width:f,height:g,cursor:t.node.isLeaf?"default":"pointer"},t.hasImage||(t.shapeArgs.d=x(m,b,f,g,y?{r:y}:void 0));t.tooltipPos=e.inverted?[o-b-g/2,l-m-f/2]:[m+f/2,b]}}ea.defaultOptions=es(t3.defaultOptions,{reversed:!1,marker:{radius:10,lineWidth:0,symbol:"circle",fillOpacity:1,states:{}},link:{color:"#666666",lineWidth:1,radius:10,cursor:"default",type:"curved"},collapseButton:{onlyOnHover:!0,enabled:!0,lineWidth:1,x:0,y:0,height:18,width:18,shape:"circle",style:{cursor:"pointer",fontWeight:"bold",fontSize:"1em"}},fillSpace:!1,tooltip:{linkFormat:"{point.fromNode.id} → {point.toNode.id}",pointFormat:"{point.id}"},dataLabels:{defer:!0,linkTextPath:{attributes:{startOffset:"50%"}},enabled:!0,linkFormatter:()=>"",pointFormat:void 0,padding:5,style:{textOverflow:"none"}},nodeDistance:30,nodeWidth:void 0}),ei(ea.prototype,{forceDL:!0,pointClass:tU,NodeClass:tR,LinkClass:tH,isCartesian:!1}),S().registerSeriesType("treegraph",ea);let en=l();export{en as default};